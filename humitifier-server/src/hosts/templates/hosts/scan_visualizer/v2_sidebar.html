{% load param_replace %}

<form method="get" class="flex gap-3 items-center mb-5" x-data="{}"
      x-ref="scanForm">
    <label for="scan" class="text-nowrap">Select scan:</label>
    <select id="scan" name="scan" class="input flex-grow"
            @change="$refs.scanForm.submit()">
        <option {% if current_scan == 'latest' %}selected{% endif %}
                value="latest">
            Latest scan
        </option>
        {% for scan in all_scans %}
            <option value="{{ scan.isoformat }}"
                    {% if current_scan == scan.isoformat %}selected{% endif %}>
                {{ scan|date:"Y-m-d H:i" }}
            </option>
        {% endfor %}
    </select>
</form>

<h3 class="text-xl font-bold mb-4">
    Static config
</h3>
<div class="grid grid-cols-1 md:grid-cols-[1fr_2fr] items-top gap-y-2">
    {% for item in static_data %}
        <div class="font-semibold">{{ item.label }}</div>
        <div class="">
            {% if item.value %}
                {{ item.value }}
            {% else %}
                <div class="text-gray-500">Unknown</div>
            {% endif %}
        </div>
    {% endfor %}
</div>

<h3 class="text-xl font-bold mb-3 mt-8">
    Actions
</h3>
<div class="flex flex-col gap-2">

    {% if request.user.is_superuser %}
        <a class="btn btn-outline"
           href="{% url 'hosts:download_raw' host.fqdn %}?{% param_replace %}">
            Download raw data
        </a>
        <div class="btn btn-outline">
            Queue full rescan
        </div>
    {% endif %}

    {% if host.can_manually_edit %}
        <a class="btn btn-outline" href="{% url 'hosts:archive' host.fqdn %}">
            Archive
        </a>
        <div class="btn btn-outline">
            Edit host config
        </div>
    {% endif %}
</div>
